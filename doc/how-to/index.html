<!doctype html>
<html>

<head>
    <meta charset="utf-8">

    <title>Plane</title>

    <style>
        /* html structure */
        html,
        body {
            height: 100%;
            margin: 0px;
            padding: 0px;
        }
        /* html structure */
        /* application structure */
        header {
            top: 0px;
            height: 40px;
            background-color: rgb(211, 222, 232);
        }
        aside {
            background-color: rgb(166, 217, 166);
        }
        aside[id=left] {
            position: absolute;
            left: 0px;
            top: 40px;
            bottom: 0px;
            width: 75px;
        }
        aside[id=right] {
            position: absolute;
            right: 0px;
            top: 40px;
            bottom: 0px;
            width: 200px;
        }
        section {
            position: absolute;
            top: 40px;
            left: 75px;
            right: 200px;
            bottom: 40px;
            background-color: rgb(234, 231, 231);
        }
        footer {
            position: absolute;
            left: 75px;
            right: 200px;
            bottom: 0px;
            height: 40px;
            background-color: rgb(239, 239, 212);
        }
        /* application structure */
        /* application components */
        canvas[id="rullery"] {
            position: absolute;
            height: 100%;
            width: 15px;
            background-color: rgb(204, 139, 139);
        }
        canvas[id="rullerx"] {
            position: absolute;
            bottom: 0px;
            height: 15px;
            width: 100%;
            background-color: rgb(204, 139, 139);
        }
        div[id="viewPort"] {
            position: absolute;
            top: 0px;
            left: 0px;
            right: 0px;
            bottom: 0px;
            background-color: rgb(68, 68, 68);
        }
        /* application components */
    </style>

    <script src="../../dist/plane-3.0.0.js"></script>

    <script>
        window.onload = function () {
            // plane - initialize
            var viewPort = document.getElementById("viewPort");

            plane.initialize({
                viewPort: viewPort,
            });
            // plane - initialize


            plane.layer.create();


            //            plane.shape.create({
            //                type: 'line',
            //                x: [350, 350],
            //                y: [600, 50]
            //            });


            plane.shape.create({
                type: 'bezier',
                points: [{
                    a: [0, 0],
                    b: [80, 40],
                    c: [80, 80]
                }]
            });

            plane.shape.create({
                type: 'bezier',
                points: [{
                    a: [75, 37],
                    b: [70, 25],
                    c: [50, 25]
                }, {
                    a: [20, 25],
                    b: [20, 62.5],
                    c: [20, 62.5]
                }, {
                    a: [20, 80],
                    b: [40, 102],
                    c: [75, 120]
                }, {
                    a: [110, 102],
                    b: [130, 80],
                    c: [130, 62.5]
                }, {
                    a: [130, 62.5],
                    b: [130, 25],
                    c: [100, 25]
                }, {
                    a: [85, 25],
                    b: [75, 37],
                    c: [75, 40]
                }]
            });

            //
            //plane.shape.create({
            //    type: 'polygon',
            //    x: 150,
            //    y: 150,
            //    radius: 70,
            //    sides: 5
            //});
            //plane.shape.create({
            //    type: 'rectangle',
            //    x: 300,
            //    y: 10,
            //    width: 125,
            //    height: 100
            //});
            //plane.shape.create({
            //    type: 'line',
            //    x: [350, 350],
            //    y: [600, 50]
            //});
            //plane.shape.create({
            //    type: 'arc',
            //    x: 800,
            //    y: 150,
            //    radius: 50,
            //    startAngle: 0,
            //    endAngle: 180,
            //    clockWise: true
            //});
            //plane.shape.create({
            //    type: 'arc',
            //    x: 500,
            //    y: 250,
            //    radius: 50,
            //    startAngle: 90,
            //    endAngle: 180,
            //    clockWise: false
            //});
            //plane.shape.create({
            //    type: 'arc',
            //    x: 700,
            //    y: 250,
            //    radius: 50,
            //    startAngle: 90,
            //    endAngle: 270,
            //    clockWise: false
            //});
            //plane.shape.create({
            //    type: 'arc',
            //    x: 1000,
            //    y: 250,
            //    radius: 50,
            //    startAngle: 90,
            //    endAngle: 270,
            //    clockWise: true
            //});
            //plane.shape.create({
            //    type: 'arc',
            //    x: 50,
            //    y: 50,
            //    radius: 30,
            //    startAngle: 90,
            //    endAngle: 180,
            //    clockWise: true
            //});
            //plane.shape.create({
            //    type: 'circle',
            //    x: 1200,
            //    y: 100,
            //    radius: 50
            //});
            //plane.shape.create({
            //    type: 'ellipse',
            //    x: 1000,
            //    y: 100,
            //    radiusY: 25,
            //    radiusX: 45
            //});
            //
            plane.update();



            var Tool001 = plane.tool.create();
            Tool001.active = true;

            console.log(Tool001);

            Tool001.listen('onMouseClick', function (event) {

                console.log(event);

                event.shapes.forEach(function (shape) {

                    if (shape.points) {

                        //                        shape.points.forEach(function(point){
                        //                        
                        //                            point.x += (10 * plane.zoom);
                        //                            point.y += (10 * plane.zoom);
                        //                        
                        //                        })
                    }

                })

                plane.update();

            });


            document.getElementById('fileImport').addEventListener('change', function () {
                var file = this.files[0],
                    filename = file.name;

                var lastDotPosition = filename.lastIndexOf('.'),
                    bareFilename = filename.substr(0, lastDotPosition),
                    fileExtension = filename.substr(lastDotPosition + 1).toLowerCase();

                var reader = new FileReader();
                reader.onload = function (event) {

                    var fileData = event.target.result;

                    switch (fileExtension) {
                    case 'dxf':
                        plane.importer.fromDxf(fileData);
                        break;
                    case 'json':
                        plane.importer.fromJson(fileData);
                        break;
                    default:
                        return;
                    }

                };
                reader.readAsText(file);
            });

            document.getElementById('exportJsonButton').addEventListener('click', function (event) {
                console.log(plane.exporter.toJson());
            });

            document.getElementById('zoomMoreButton').addEventListener('click', function (event) {
                plane.zoom /= .9;
            });

            document.getElementById('zoomLessButton').addEventListener('click', function (event) {
                plane.zoom *= .9;
            });

            document.getElementById('scrollButton').addEventListener('click', function (event) {
                var scrollInputx = document.getElementById('scrollInputx'),
                    scrollInputy = document.getElementById('scrollInputy'),
                    scroll = {
                        x: parseInt(scrollInputx.value),
                        y: parseInt(scrollInputy.value)
                    };
                plane.scroll = scroll;
            });

        };
    </script>

</head>

<body>

    <header>
    </header>

    <aside id="left">
    </aside>

    <section>
        <div id="viewPort">
        </div>
    </section>

    <aside id="right">
        <ul id="layersControl">
        </ul>
        <div id="toolsPanel">
            <input id="fileImport" type="file"></input>
            <button id="exportJsonButton">Export Json</button>
            <br>
            <br>
            <button id="zoomMoreButton">Zoom +++</button>
            <button id="zoomLessButton">Zoom ---</button>
            <br>
            <br>
            <label>x</label>
            <input id="scrollInputx" type="text" style="width:60px" value="5">
            <label>y</label>
            <input id="scrollInputy" type="text" style="width:60px" value="5">
            <button id="scrollButton">Scroll</button>
        </div>
        <ul id="shapesList">
        </ul>
    </aside>

    <footer>
    </footer>
</body>

</html>