<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <title>Plane - How-To</title>

    <style>
        /* html structure */
        html,
        body {
            height: 100%;
            margin: 0px;
            padding: 0px;
        }
        /* html structure */
        /* application structure */
        header {
            top: 0px;
            height: 40px;
            background-color: rgb(211, 222, 232);
        }
        aside {
            background-color: rgb(166, 217, 166);
        }
        aside[id=left] {
            position: absolute;
            left: 0px;
            top: 40px;
            bottom: 0px;
            width: 75px;
        }
        aside[id=right] {
            position: absolute;
            right: 0px;
            top: 40px;
            bottom: 0px;
            width: 200px;
        }
        section {
            position: absolute;
            top: 40px;
            left: 75px;
            right: 200px;
            bottom: 40px;
            background-color: rgb(234, 231, 231);
        }
        footer {
            position: absolute;
            left: 75px;
            right: 200px;
            bottom: 0px;
            height: 40px;
            background-color: rgb(239, 239, 212);
        }
        /* application structure */
        /* application components */
        canvas[id="rullerY"] {
            position: absolute;
            height: 100%;
            width: 15px;
            background-color: rgb(204, 139, 139);
        }
        canvas[id="rullerX"] {
            position: absolute;
            bottom: 0px;
            height: 15px;
            width: 100%;
            background-color: rgb(204, 139, 139);
        }
        div[id="viewPort"] {
            position: absolute;
            top: 0px;
            left: 15px;
            right: 0px;
            bottom: 15px;
            background-color: rgb(68, 68, 68);
        }
        /*
        div[id="viewPort"] > canvas {
            background-color: rgb(255, 255, 255);
        }
*/
        /* application components */
    </style>

    <script src="../../dist/plane-1.0.0.js"></script>

    <script>
        window.onload = function () {

            // plane - initialize
            var viewPort = document.getElementById("viewPort");

            Plane.Initialize({
                viewPort: viewPort,
                //                                style: {
                //                                    gridEnable: true,
                //                                    gridColor: 'red'
                //                                }
            });

            Plane.addEventListener('onChange', function (event) {
                console.log(event);
            });
            Plane.addEventListener('onResize', function (event) {
                console.log(event);
            });
            Plane.addEventListener('onKeyDown', function (event) {
                console.log(event);
            });

            Plane.Layers.addEventListener('onDeactive', function (event) {
                console.log(event);
            });
            Plane.Layers.addEventListener('onActive', function (event) {
                console.log(event);
            });
            // plane - initialize


            //            Plane.Layers.Create();
            //            Plane.Shape
            //                .Create({
            //                    type: 'polygon',
            //                    x: 900,
            //                    y: 500,
            //                    radius: 70,
            //                    sides: 3
            //                })
            //                .Create({
            //                    type: 'rectangle',
            //                    x: 150,
            //                    y: 150,
            //                    width: 125,
            //                    height: 100
            //                })
            //                .Create({
            //                    type: 'ellipse',
            //                    x: 450,
            //                    y: 300,
            //                    width: 45,
            //                    height: 25
            //                })
            //                .Create({
            //                    type: 'line',
            //                    x: [50, 50],
            //                    y: [1600, 50]
            //                })
            //                .Create({
            //                    type: 'arc',
            //                    x: 600,
            //                    y: 300,
            //                    radius: 50,
            //                    startAngle: 0,
            //                    endAngle: 180,
            //                    clockWise: false
            //                })
            //                .Create({
            //                    type: 'circle',
            //                    x: 1200,
            //                    y: 300,
            //                    radius: 80
            //                })
            //                .Create({
            //                    type: 'polygon',
            //                    x: 600,
            //                    y: 500,
            //                    radius: 70,
            //                    sides: 5
            //                });
            //            Plane.Render.Update();

            var layersControl = document.getElementById('layersControl');
            Plane.Layers.List().forEach(function (layer) {
                var layerItem = document.createElement('li');
                layerItem.innerHTML = '<a href="#">' + layer.name + '</a>'
                layersControl.appendChild(layerItem);
            });

            var shapesList = document.getElementById('shapesList');
            Plane.Shape.Search().forEach(function (shape) {
                var shapeItem = document.createElement('li');
                shapeItem.innerHTML = shape.type + ' - ' + shape.uuid;
                shapesList.appendChild(shapeItem);
            })

            document.getElementById('shapeMoveButton').addEventListener('click', function (event) {

                var shapeMoveInput = document.getElementById('shapeMoveInput');
                shape = Plane.Shape.Search('shape > uuid'.concat(shapeMoveInput.value));

                //                shape.x = shape.x + 100;
                shape.angle = shape.angle + 10;

                Plane.Render.Update();

                //console.log(shape);

            });


            document.getElementById('exportJsonButton').addEventListener('click', function (event) {

                console.log(Plane.exportJson());

            });

            document.getElementById('zoomMoreButton').addEventListener('click', function (event) {

                Plane.zoom = Math.pow(1.03, 1);

            });

            document.getElementById('zoomLessButton').addEventListener('click', function (event) {
                Plane.zoom = Math.pow(1.03, -1);
            });

            document.getElementById('centerButton').addEventListener('click', function (event) {

                var centerInputX = document.getElementById('centerInputX'),
                    centerInputY = document.getElementById('centerInputY'),
                    center = {
                        x: centerInputX.value,
                        y: centerInputY.value
                    };

                Plane.center = center;
            });





            var tool001 = Plane.Tools.Create(),
                toolsList = Plane.Tools.List();

            console.log(tool001);
            console.log(toolsList);

            tool001.addEventListener('onActive', function (event) {
                console.log(event);
            });
            tool001.addEventListener('onDeactive', function (event) {
                console.log(event);
            });

            var lineClick = null;


            //            var zzz = new Plane.Point(200, 400);
            //            var ccc = Plane.Point.Create(200, 400);


            tool001.addEventListener('onClick', function (event) {

                if (!lineClick) {
                    lineClick = {
                        x: event.x,
                        y: event.y
                    }
                } else {
                    Plane.Shape.Create({
                        type: 'line',
                        x: [lineClick.x, lineClick.y],
                        y: [event.x, event.y]
                    })

                    lineClick = null;
                }

                console.log(event);
                Plane.Render.Update();

            });

            tool001.addEventListener('onMouseWheel', function (event) {
                console.log(event);
            });

            tool001.addEventListener('onMouseMove', function (event) {
                console.log(event);
            });

            tool001.active = true;
            //            tool001.active = false;


            document.getElementById('fileImport').addEventListener('change', function () {
                var file = this.files[0],
                    filename = file.name;

                var lastDotPosition = filename.lastIndexOf('.'),
                    bareFilename = filename.substr(0, lastDotPosition),
                    fileExtension = filename.substr(lastDotPosition + 1).toLowerCase();


                var reader = new FileReader();

                reader.onload = function (event) {

                    var fileData = event.target.result,
                        svgString = '';

                    switch (fileExtension) {
                    case 'dxf':
                        Plane.importDxf(fileData);
                        break;
                    case 'json':
                        Plane.importJson(fileData);
                        break;
                    default:
                        return;
                    }

                };

                reader.readAsText(file);






            });


        }
    </script>

</head>

<body>

    <header>
    </header>

    <aside id="left">
    </aside>

    <section>
        <canvas id="rullerX"></canvas>
        <div id="viewPort">
            <!--
            <ul>
                <li></li>
                <li></li>
                <li></li>
            </ul>
            -->
        </div>
        <canvas id="rullerY"></canvas>
    </section>

    <aside id="right">
        <ul id="layersControl">
        </ul>
        <div id="toolsPanel">
            <input id="fileImport" type="file"></input>
        </div>
        <ul id="shapesList">
        </ul>
        <input id="shapeMoveInput" type="text">
        <button id="shapeMoveButton">Shape Move</button>
        <button id="exportJsonButton">Export Jason</button>
        <button id="zoomMoreButton">Zoom +++</button>
        <button id="zoomLessButton">Zoom ---</button>
        <input id="centerInputX" type="text" style="width:50px" value="10">
        <input id="centerInputY" type="text" style="width:50px" value="10">
        <button id="centerButton">Center</button>
    </aside>

    <footer>
    </footer>
</body>

</html>