/*!
 * C37 in 06-05-2014 at 11:07:17 
 *
 * plane version: 1.0.0
 * licensed by Creative Commons Attribution-ShareAlike 3.0
 *
 * Copyright - C37 http://c37.co - 2014
 */
!function(a){"use strict";var b={};b.version="1.0.0",b.author="lilo@c37.co",b.initialize=function(a){return b.layers.initialize(a),b.render.initialize(a),console.log(b.layers.list()),b.render.initialize(a)},b.utility={},a.plane=b}(window),plane.layers=function(a){"use strict";function b(b){var d=a.utility.math.uuid(9,16),e="",f={},g=[];this.getUuid=function(){return d},this.setName=function(a){if(null==a||void 0==a||""==a)throw new Error("New name is not defined");for(var b=0;b<=c.length-1;b++)if(c[b].getName().toLowerCase()==a.toLowerCase())throw new Error("This name "+a+" already exists in Layers");return e=a,this},this.getName=function(){return e},this.getStyle=function(){return f},this.setStyle=function(){return this},this.shapes={add:function(a){return g.push(a),this},search:function(){return g},remove:function(a){return g.slice(g.indexOf(a)),this}},this.initialize(b)}var c=[];return b.prototype={initialize:function(a){return this.setName(a.name),this},toString:function(){return"[ Layer uuid:"+this.getUuid()+", name:"+this.getName()+", active:"+this.getActive()+"]"}},{initialize:function(d){if("function"==typeof d)throw new Error("Layer - Initialize - Config is not valid");var d={name:d?d.name||"New Layer "+c.length:"New Layer "+c.length,active:d?d.active||!0:!0},e=new b(d);return a.layers.active=e,c.push(e),this},create:function(d){if("function"==typeof d)throw new Error("Layer - Create - Config is not valid");var d={name:d?d.name||"New Layer "+c.length:"New Layer "+c.length},e=new b(d);return a.layers.active=e,c.push(e),this},remove:function(a){for(var b=0;b<=c.length-1;b++)if(c[b].getName()==a)return delete c[b];return!1},list:function(a){var b=[];return c.forEach(function(a){b.push({uuid:a.getUuid(),name:a.getName()})}),"function"==typeof a?a.call(this,b):b},select:function(b){return c.forEach(function(c){c.getName()==b&&(a.layers.active=c)}),this},active:null}}(plane),plane.render=function(a){"use strict";function b(){return"canvas"}var c=null,d=[];return{initialize:function(e){if("function"==typeof e)throw new Error("Render - Initialize - Config is not valid");var e={renderType:e?e.renderType||b():b(),renderer:e?e.renderer||null:null},f={canvas:a.render.canvas,svg:a.render.svg};return c=f[e.renderType],d.push(c.create(e)),this},update:function(){var b=a.layers.active.shapes.search();b.length>0&&c.update(b)}}}(plane),plane.shape=function(a){"use strict";return{create:function(b){return a.layers.active.shapes.add(b),this},search:function(){return a.layers.active.shapes.search()},remove:function(b){return a.layers.active.shapes.remove(b)}}}(plane),plane.render.canvas=function(){var a=null,b=null;return{create:function(c){function d(a,b){var c=a.getBoundingClientRect(),d=(b.clientX-c.left)*(a.width/c.width),e=(b.clientY-c.top)*(a.height/c.height);return{x:d,y:e}}function e(a,c){var d=a.getBoundingClientRect(),e=(c.clientX-d.left)*(a.width/d.width),f=(c.clientY-d.top)*(a.height/d.height);return b.isPointInPath(e,f)}if(a=document.createElement("canvas"),a=c.renderer,a.width=c.renderer.clientWidth,a.height=c.renderer.clientHeight,!a.getContext)throw new Error("no canvas suport");return b=a.getContext("2d"),b.translate(0,a.height),b.scale(1,-1),a.onmousewheel=function(a){console.log(a)},a.onclick=function(c){var f=d(a,c),g=document.getElementById("debug");g.innerHTML="x: "+f.x+", y:"+f.y+", selected: "+e(a,c),console.log(b.getImageData(f.x,f.y,3,3).data)},a.oncontextmenu=function(a){return console.log(a),!1},a},update:function(c){b.clearRect(0,0,a.width,a.height),c.forEach(function(a){switch(b.save(),b.beginPath(),a.type){case"line":b.lineWidth=a.strokeWidth||1,b.strokeStyle=a.strokeColor||"black",b.moveTo(a.x[0],a.x[1]),b.lineTo(a.y[0],a.y[1]);break;case"rectangle":b.lineWidth=a.strokeWidth||1,b.strokeStyle=a.strokeColor||"black",b.strokeRect(a.x,a.y,a.width,a.height);break;case"arc":break;case"circle":b.arc(a.x,a.y,a.radius,0,2*Math.PI,!0),b.closePath();break;case"ellipse":break;case"polygon":if(a.sides<3)throw new Error("shape.sides < 3");var c=2*Math.PI/a.sides;b.translate(a.x,a.y),b.moveTo(a.radius,0);for(var d=1;d<a.sides;d++)b.lineTo(a.radius*Math.cos(c*d),a.radius*Math.sin(c*d));b.closePath()}b.fill(),b.stroke(),b.restore()})}}}(plane),function(a){"use strict";function b(a){if(0==arguments.length)throw new SyntaxError("svg - no arguments");return this instanceof b?void(this.type="svg"):new b(a)}a.render.svg=b}(plane),plane.utility.events=function(){"use strict";return{subscribe:function(){},unsubscribe:function(){}}}(plane),function(a){"use strict";a.utility.math={uuid:function(a,b){var c,d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),e=[];if(b=b||d.length,a)for(c=0;a>c;c++)e[c]=d[0|Math.random()*b];else{var f;for(e[8]=e[13]=e[18]=e[23]="-",e[14]="4",c=0;36>c;c++)e[c]||(f=0|16*Math.random(),e[c]=d[19==c?3&f|8:f])}return e.join("").toLowerCase()},calculeX:function(a,b){return a+b}}}(plane);